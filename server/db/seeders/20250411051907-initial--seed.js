'use strict';
const bcrypt = require('bcrypt');

/** @type {import('sequelize-cli').Migration} */
module.exports = {
  async up(queryInterface, Sequelize) {
    const hashedPassword = await bcrypt.hash('admin123', 10); // Хешируем пароль
    
    // Создаём пользователя
    const [userId] = await queryInterface.bulkInsert('Users', [{
      name: 'Admin',
      email: 'admin@example.com',
      password: hashedPassword, // Используем свежий хеш
      createdAt: new Date(),
      updatedAt: new Date()
    }], {
      returning: ['id']
    });

    // Теперь добавляем чаи с корректным userId
    await queryInterface.bulkInsert('Teas', [
      {
        name: 'Пряная Вишня',
        type: 'Чёрный',
        description: 'Чай заварочный черный листовой Пряная Вишня, 100 г. Подарок маме, подарок бабушке',
        compound: 'Черный индийский чай, вишня сушеная, апельсин сушеный, бутоны желтой розы, цветки апельсинового дерева, натуральный ароматизатор, эфирное масло корицы.',
        userId: 1, // ID пользователя-администратора (предполагаем, что он равен 1)
        price: 312,
        image: 'pryanayavishny.jpg',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Набор чая ягодный',
        type: 'Чай листовой',
        description: 'Ароматный черный чай с бергамотом.',
        compound: 'Иммунный с клубникой и шиповником 600 мл, брусника стравами 600 мл, лесные ягоды 600 мл',
        userId: 1, // ID пользователя-администратора
        price: 533,
        image: 'bum.JPG',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Черный чай листовой Айва с персиком',
        type: 'Чёрный',
        description: 'Купаж Айвы с персиком на основе черного индийского листового чая с добавлением кусочков яблок, сушеного абрикоса, мяты, лепестков сафлора и ароматом спелой айвы и сочного персика. ',
        compound: 'черный чай; яблоко; абрикос; мята; сафлор; ароматизатор',
        userId: 1, // ID пользователя-администратора
        price: 362,
        image: 'pers.png',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Подарочный Таежный сбор чай черный',
        type: 'Чёрный',
        description: 'Дары тайги, терпкий вкус и чарующий аромат подарят вам заряд бодрости на весь день. ',
        compound: 'Индийский Черный чай; ягоды можжевельника; ягоды брусники; мелисса; ягоды ежевики; кусочки клюквы; кусочки малины; лепестки календулы; ',
        userId: 1, // ID пользователя-администратора
        price: 486,
        image: 'tay.png',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Чай листовой фруктовый',
        type: 'Зеленый',
        description: 'Чайный набор содержит крупнолистовой китайский рассыпной продукт с добавлением натуральных фруктов и ягод. Включены ингредиенты с мелиссой, мятой, клубникой и земляникой, что придаст напитку бодрящий эффект.',
        compound: 'зеленый чай; груша; ананас; изюм; рябина; шиповник; гибискус; свекла; брусника ',
        userId: 1, // ID пользователя-администратора
        price: 341,
        image: 'fruit.png',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Подарочный набор чай листовой ассорти',
        type: 'Чёрный',
        description: 'Подарочный набор из 6 авторских купажей чая в красивой крафтовой коробке — это сочетание вкуса, пользы и эстетики. ',
        compound: 'смородина; лаванда; лайм; роза; шиповник; мята; лимон; клубника; лемонграсс; жасмин; малина; ромашка; ежевика; календула; земляника; мальва; липа; мед; облепиха; клюква ',
        userId: 1, // ID пользователя-администратора
        price: 1426,
        image: 'nab.png',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Травяной чай "Цитрусовый" с гибискусом и лемонграссом',
        type: 'Чёрный',
        description: '«Цитрусовый» встретит вас взрывным и ярким вкусом. Кислинка гибискуса с освежающей ноткой лемонграсса, пряным и острым послевкусием имбиря. ',
        compound: 'лемонграсс; гибискус; апельсин; имбирь',
        userId: 1, // ID пользователя-администратора
        price: 323,
        image: 'trav.png',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'ЧАЙНЫЙ ГЛИНТВЕЙН с фруктами и специями',
        type: 'Чёрный',
        description: 'Теперь вы можете приготовить Глинтвейн за 15 секунд и даже взять его с собой. Просто залейте содержимое пакета кипятком и хорошо перемешайте.  ',
        compound: 'Кусочки яблок, корицы, имбиря, цветки каркадэ, кусочки звездочек бадьяна, кардамон, кусочки и слайсы апельсина с цедрой, гвоздика, розовый перец, демерара, гранулы клубничного меда, гранулы клубничного сока',
        userId: 1, // ID пользователя-администратора
        price: 350,
        image: 'glint.JPG',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Набор авторского чая "ИММУНИТЕТ"',
        type: 'Чёрный',
        description: 'Чайный набор "ИММУНИТЕТ | 31 стакан авторского чая на каждый день месяца" в удобной коробке-диспенсере. В этот набор мы включили 4 сорта нашего авторского чая, благотворно влияющие на иммунитет.',
        compound: 'Иммунный с облепихой, медовое яблоко с имбирем, малина с мятой, кедровый с чагой',
        userId: 1, // ID пользователя-администратора
        price: 2050,
        image: 'bignab.JPG',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
      {
        name: 'Китайский улун С ЗЕМЛЯНИКОЙ',
        type: 'Чёрный',
        description: 'Рекомендуем этот авторский купаж всем любителям тонкого вкуса зеленого китайского чая и улунов.',
        compound: 'Чай китайский полуферментированный улун (Фуцзянь), слайсы клубники, ягоды земляники, листья брусники, гранулы клубничного меда.',
        userId: 1, // ID пользователя-администратора
        price: 399,
        image: 'zem.JPG',
        createdAt: new Date(), // Добавлено
        updatedAt: new Date()  // Добавлено
      },
    ], {});
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.bulkDelete('Users', { email: 'admin@example.com' }, {});
    await queryInterface.bulkDelete('Teas', null, {});
  }
};